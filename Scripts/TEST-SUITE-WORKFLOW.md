# AdminPortal Test Suite - Visual Workflow

**Created**: February 3, 2026  
**Purpose**: Visual guide to test suite execution flow

---

## ?? Test Suite Execution Flow

```
????????????????????????????????????????????????????????????????????
?                                                                  ?
?          BELLWOOD ADMINPORTAL TEST SUITE                         ?
?          test-adminportal-complete.ps1                           ?
?                                                                  ?
????????????????????????????????????????????????????????????????????
                              ?
                              ?
????????????????????????????????????????????????????????????????????
?  STEP 1: Initialize                                              ?
?  • Parse command-line parameters                                ?
?  • Set up SSL trust policy                                      ?
?  • Initialize test counters                                     ?
?  • Display banner & configuration                               ?
????????????????????????????????????????????????????????????????????
                              ?
                              ?
????????????????????????????????????????????????????????????????????
?  STEP 2: Server Health Checks (unless -SkipServerCheck)         ?
?  ?????????????????????????????????????????????????????????????? ?
?  ?  AuthServer Health:    GET /health                         ? ?
?  ?  ? Expected: 200 OK                                        ? ?
?  ?????????????????????????????????????????????????????????????? ?
?  ?????????????????????????????????????????????????????????????? ?
?  ?  AdminAPI Health:      GET /health                         ? ?
?  ?  ? Expected: 200 OK                                        ? ?
?  ?????????????????????????????????????????????????????????????? ?
?  ?????????????????????????????????????????????????????????????? ?
?  ?  AdminPortal Health:   GET /                               ? ?
?  ?  ? Expected: 200 OK                                        ? ?
?  ?????????????????????????????????????????????????????????????? ?
?                                                                  ?
?  If any fail ? Prompt user to continue or abort                 ?
????????????????????????????????????????????????????????????????????
                              ?
                              ?
????????????????????????????????????????????????????????????????????
?  STEP 3: Phase 1 Tests - Core Infrastructure                    ?
?  ?????????????????????????????????????????????????????????????? ?
?  ?  Test [1/6]: API Connectivity & Health                    ? ?
?  ?  Script: test-api-connection.ps1                          ? ?
?  ?  ???????????????????????????????????????????????????????? ? ?
?  ?  ?  • Test /health endpoint                             ? ? ?
?  ?  ?  • Seed test bookings                                ? ? ?
?  ?  ?  • Fetch bookings list                               ? ? ?
?  ?  ?  • Verify API key auth                               ? ? ?
?  ?  ???????????????????????????????????????????????????????? ? ?
?  ?  Result: PASSED (2.3s) ?                                  ? ?
?  ?????????????????????????????????????????????????????????????? ?
????????????????????????????????????????????????????????????????????
                              ?
                              ?
????????????????????????????????????????????????????????????????????
?  STEP 4: Phase 2 Tests - Authentication & Authorization         ?
?  ?????????????????????????????????????????????????????????????? ?
?  ?  Test [2/6]: JWT Decoding & Role Extraction               ? ?
?  ?  Script: test-phase2-jwt-decoding.ps1                     ? ?
?  ?  ???????????????????????????????????????????????????????? ? ?
?  ?  ?  • Login as alice                                    ? ? ?
?  ?  ?  • Decode JWT token                                  ? ? ?
?  ?  ?  • Extract role claim                                ? ? ?
?  ?  ?  • Verify userId claim                               ? ? ?
?  ?  ???????????????????????????????????????????????????????? ? ?
?  ?  Result: PASSED (1.8s) ?                                  ? ?
?  ?????????????????????????????????????????????????????????????? ?
?  ?????????????????????????????????????????????????????????????? ?
?  ?  Test [3/6]: Token Refresh Mechanism                      ? ?
?  ?  Script: test-phase2-token-refresh.ps1                    ? ?
?  ?  ???????????????????????????????????????????????????????? ? ?
?  ?  ?  • Get initial access token                          ? ? ?
?  ?  ?  • Extract refresh token                             ? ? ?
?  ?  ?  • Call refresh endpoint                             ? ? ?
?  ?  ?  • Verify new token issued                           ? ? ?
?  ?  ???????????????????????????????????????????????????????? ? ?
?  ?  Result: PASSED (2.1s) ?                                  ? ?
?  ?????????????????????????????????????????????????????????????? ?
?  ?????????????????????????????????????????????????????????????? ?
?  ?  Test [4/6]: User Management & Role Assignment            ? ?
?  ?  Script: test-phase2-user-management.ps1                  ? ?
?  ?  ???????????????????????????????????????????????????????? ? ?
?  ?  ?  • Authenticate as admin                             ? ? ?
?  ?  ?  • List users                                        ? ? ?
?  ?  ?  • Create test user                                  ? ? ?
?  ?  ?  • Update user roles                                 ? ? ?
?  ?  ?  • Verify role changes                               ? ? ?
?  ?  ???????????????????????????????????????????????????????? ? ?
?  ?  Result: PASSED (3.2s) ?                                  ? ?
?  ?????????????????????????????????????????????????????????????? ?
?  ?????????????????????????????????????????????????????????????? ?
?  ?  Test [5/6]: 403 Forbidden Error Handling                 ? ?
?  ?  Script: test-phase2-403-handling.ps1                     ? ?
?  ?  ???????????????????????????????????????????????????????? ? ?
?  ?  ?  • Attempt admin action as dispatcher                ? ? ?
?  ?  ?  • Verify 403 response                               ? ? ?
?  ?  ?  • Check error message                               ? ? ?
?  ?  ?  • Verify graceful handling                          ? ? ?
?  ?  ???????????????????????????????????????????????????????? ? ?
?  ?  Result: PASSED (1.5s) ?                                  ? ?
?  ?????????????????????????????????????????????????????????????? ?
????????????????????????????????????????????????????????????????????
                              ?
                              ?
????????????????????????????????????????????????????????????????????
?  STEP 5: Phase B Tests - Quote Lifecycle                        ?
?  ?????????????????????????????????????????????????????????????? ?
?  ?  Test [6/6]: Quote Lifecycle Workflow                     ? ?
?  ?  Script: test-phase-b-quote-lifecycle.ps1                 ? ?
?  ?  ???????????????????????????????????????????????????????? ? ?
?  ?  ?  • Authenticate as alice                             ? ? ?
?  ?  ?  • Fetch quotes list                                 ? ? ?
?  ?  ?  • Get pending quote count                           ? ? ?
?  ?  ?  • Get quote detail                                  ? ? ?
?  ?  ?  • Acknowledge quote                                 ? ? ?
?  ?  ?  • Respond with price estimate                       ? ? ?
?  ?  ???????????????????????????????????????????????????????? ? ?
?  ?  Result: PASSED (4.1s) ?                                  ? ?
?  ?????????????????????????????????????????????????????????????? ?
????????????????????????????????????????????????????????????????????
                              ?
                              ?
????????????????????????????????????????????????????????????????????
?  STEP 6: Generate Summary & Export Results                      ?
?  ?????????????????????????????????????????????????????????????? ?
?  ?  Calculate Statistics:                                     ? ?
?  ?  • Total tests: 6                                         ? ?
?  ?  • Passed: 6                                              ? ?
?  ?  • Failed: 0                                              ? ?
?  ?  • Skipped: 0                                             ? ?
?  ?  • Pass rate: 100%                                        ? ?
?  ?  • Duration: 15.0s                                        ? ?
?  ?????????????????????????????????????????????????????????????? ?
?  ?????????????????????????????????????????????????????????????? ?
?  ?  Display Summary:                                          ? ?
?  ?  ?????????????????????????????????????????????????????    ? ?
?  ?  ?           TEST SUITE SUMMARY                      ?    ? ?
?  ?  ?????????????????????????????????????????????????????    ? ?
?  ?                                                            ? ?
?  ?  ?? Overall Results:                                       ? ?
?  ?    Total Tests:    6                                      ? ?
?  ?    ? Passed:      6                                       ? ?
?  ?    ? Failed:      0                                       ? ?
?  ?    ?? Skipped:     0                                       ? ?
?  ?                                                            ? ?
?  ?    Pass Rate:      100.0%                                 ? ?
?  ?    Duration:       15.0s                                  ? ?
?  ?                                                            ? ?
?  ?  ?? SUCCESS! All tests passed!                            ? ?
?  ?  AdminPortal is ready for deployment! ??                  ? ?
?  ?????????????????????????????????????????????????????????????? ?
?  ?????????????????????????????????????????????????????????????? ?
?  ?  Export to JSON:                                           ? ?
?  ?  File: test-results-20260203-143000.json                  ? ?
?  ?  Format: Array of test result objects                     ? ?
?  ?????????????????????????????????????????????????????????????? ?
????????????????????????????????????????????????????????????????????
                              ?
                              ?
????????????????????????????????????????????????????????????????????
?  STEP 7: Exit with Status Code                                  ?
?  • 0 = All tests passed ?                                       ?
?  • 1 = One or more tests failed ?                               ?
????????????????????????????????????????????????????????????????????
```

---

## ?? Decision Points

### Server Health Check Failure

```
Server not responding
         ?
         ?? Yes to continue ?? Run tests anyway (may fail)
         ?
         ?? No to continue ??? Exit suite (code 1)
```

### Test Failure (with -StopOnFailure)

```
Test fails
         ?
         ?? -StopOnFailure flag ?? Show summary, exit (code 1)
         ?
         ?? No flag ?????????????? Continue to next test
```

### Test Script Missing

```
Script not found
         ?
         ?? Mark as SKIPPED ????? Continue to next test
```

---

## ?? Test Result States

```
???????????????????????????????????????????????????????????????
?  Test Execution                                             ?
?                                                             ?
?  ???????????         ???????????         ???????????      ?
?  ? Script  ??????    ?  Run    ??????    ? Result  ?      ?
?  ? Exists? ?         ?  Test   ?         ? State   ?      ?
?  ???????????         ???????????         ???????????      ?
?       ?                   ?                   ?            ?
?       ?                   ?                   ?? PASSED   ?
?       ?                   ?                   ?? FAILED   ?
?       ?                   ?                   ?? ERROR    ?
?       ?                   ?                   ?? SKIPPED  ?
?       ?                   ?                                ?
?       ?? Yes ??????????????                                ?
?       ?                                                    ?
?       ?? No ??????????????????????????????? SKIPPED       ?
?                                                            ?
??????????????????????????????????????????????????????????????
```

---

## ?? Parallel vs Sequential Execution

**Current**: Sequential (one test at a time)

```
Test 1 ??? Test 2 ??? Test 3 ??? Test 4 ??? Test 5 ??? Test 6
  2s        2s        3s        2s        2s        4s
  
Total: 15s
```

**Future**: Parallel (not implemented - may cause conflicts)

```
         ??? Test 1 (2s) ???
         ??? Test 2 (2s) ???
Start ?????? Test 3 (3s) ????? End
         ??? Test 4 (2s) ???
         ??? Test 5 (2s) ???
         ??? Test 6 (4s) ???
         
Total: 4s (max test duration)
```

**Note**: Parallel execution not recommended - tests may interfere with shared state

---

## ?? File Structure

```
Scripts/
??? test-adminportal-complete.ps1        ? Master orchestrator
??? test-api-connection.ps1              ? Phase 1 test
??? test-phase2-jwt-decoding.ps1         ? Phase 2 test
??? test-phase2-token-refresh.ps1        ? Phase 2 test
??? test-phase2-user-management.ps1      ? Phase 2 test
??? test-phase2-403-handling.ps1         ? Phase 2 test
??? test-phase-b-quote-lifecycle.ps1     ? Phase B test
??? README-Complete-Test-Suite.md        ? Full documentation
??? TEST-SUITE-QUICK-REF.md              ? Quick reference
??? test-results-*.json                  ? Generated results
```

---

## ?? Color Coding

```
???????????????????????????????????????????????????????????
?  Console Output Colors:                                 ?
?                                                         ?
?  Cyan      - Headers, banners, section dividers        ?
?  Green     - Success messages, passed tests            ?
?  Red       - Errors, failed tests                      ?
?  Yellow    - Warnings, skipped tests                   ?
?  Gray      - Timestamps, metadata                      ?
?  White     - Normal text, descriptions                 ?
?  DarkGray  - Separators, borders                       ?
?                                                         ?
???????????????????????????????????????????????????????????
```

---

## ?? Optimization Opportunities

### Current Performance
- **Sequential execution**: ~15 seconds
- **No caching**: Fresh state each run
- **Full suite**: All tests every time

### Potential Optimizations
1. **Smart test selection**: Only run affected tests
2. **Test caching**: Skip unchanged tests
3. **Parallel execution**: Run independent tests simultaneously
4. **Incremental testing**: Quick smoke tests, full suite on-demand

---

**Visual Guide Version**: 1.0  
**Last Updated**: February 3, 2026  
**Status**: Documentation Complete
